<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simple$$ ‚Äî M√∫ltiplas Caixas</title>

  <!-- Manifest PWA -->
  <link rel="manifest" href="/simpless/manifest.json" />
  <meta name="theme-color" content="#f7941d" />

  <!-- iOS (modo app + √≠cone) -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Simple$$" />
  <link rel="apple-touch-icon" sizes="180x180" href="/simpless/icons/apple-touch-icon.png" />

  <!-- Favicons / fallback -->
  <link rel="icon" type="image/png" sizes="32x32" href="/simpless/icons/favicon-32.png" />
  <link rel="icon" type="image/png" sizes="64x64" href="/simpless/icons/favicon-64.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/simpless/icons/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/simpless/icons/icon-512.png" />

  <!-- CSS -->
  <link rel="stylesheet" href="/simpless/style.css?v=9" />

  <!-- CSS cr√≠tico inline -->
  <style>
    :root{
      --bg:#f2f4f8; --fg:#222; --card:#fff; --muted:#666;
      --primary:#0d6efd; --danger:#dc3545; --ok:#28a745;
      --footer-h:56px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:"Segoe UI",system-ui,-apple-system,Arial,sans-serif;
      background:var(--bg);color:var(--fg);margin:0;
    }
    main{
      max-width:700px;margin:0 auto;min-height:100dvh;padding:1.2rem;
      /* espa√ßo para o rodap√© fixo n√£o cobrir conte√∫do */
      padding-bottom: calc(var(--footer-h) + env(safe-area-inset-bottom, 0px) + 16px);
    }

    .topbar{display:flex;align-items:center;gap:.6rem}
    .topbar h1{margin:.2rem 0;font-size:1.6rem}
    .subtitle{color:var(--muted);font-size:.9rem}
    .panel-head{display:flex;justify-content:space-between;align-items:center;margin:.5rem 0}
    .card{background:var(--card);border-radius:12px;padding:1rem;
      box-shadow:0 2px 10px rgba(0,0,0,.05);margin:.8rem 0;}
    button{border:none;border-radius:10px;padding:.7rem 1rem;cursor:pointer;font-size:1rem;}
    button.primary{background:var(--primary);color:#fff}
    button.ghost{background:#e9eef6;color:#111}
    button.danger{background:var(--danger);color:#fff}
    .box-list{list-style:none;padding:0;margin:0}
    .box-item{display:flex;justify-content:space-between;align-items:center;
      padding:.8rem 1rem;border-radius:12px;background:#fff;
      box-shadow:0 1px 6px rgba(0,0,0,.04);margin:.6rem 0;cursor:pointer}
    .box-left{display:flex;align-items:center;gap:.8rem}
    .color-dot{width:8px;height:20px;border-radius:4px}
    .badge{background:#eef1f6;border-radius:999px;padding:.1rem .5rem;color:#333;font-size:.75rem}
    .balance-positive{color:var(--ok)}
    .balance-negative{color:var(--danger)}
    fieldset.period-field{border:1px solid #eee;border-radius:10px;padding:.6rem;margin:.6rem 0;}
    .hidden{display:none}
    .actions{display:flex;gap:.6rem;justify-content:flex-end;margin-top:1rem}
    input[type="text"],input[type="number"]{
      width:100%;padding:.7rem;border:1px solid #ddd;border-radius:10px;font-size:16px;
    }
    .row{display:flex;gap:.6rem;align-items:center}
    .row.end{justify-content:flex-end}
    .expense-list{list-style:none;padding:0;margin:0}
    .exp-item{
      display:flex;justify-content:space-between;align-items:center;
      border-bottom:1px solid #eee;padding:.5rem 0
    }
    .exp-item .actions{display:flex;gap:.4rem}
    .edit-btn{background:#ffc107;color:#111;border:none;border-radius:8px;padding:.35rem .6rem;cursor:pointer;font-size:.85rem}
    .del-btn{background:var(--danger);color:#fff;border:none;border-radius:8px;padding:.35rem .6rem;cursor:pointer;font-size:.85rem}

    /* Rodap√© fixo vis√≠vel no app instalado (Android/iOS) */
    footer.foot{
      position:fixed;left:0;right:0;bottom:0;height:var(--footer-h);
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,.92);
      -webkit-backdrop-filter:saturate(180%) blur(8px);
      backdrop-filter:saturate(180%) blur(8px);
      border-top:1px solid #eee;
      padding:0 12px;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 6px);
      z-index:1000;
      color:#555;
      font-size:.9rem;
      text-align:center;
    }
    footer.foot a{
      color:#555;
      text-decoration:underline;
      text-underline-offset:2px;
    }
  </style>
</head>
<body>
  <main>
    <header class="topbar">
      <h1>üíµ Simple$$</h1>
      <span class="subtitle">Caixas simples por per√≠odo</span>
    </header>

    <!-- Painel -->
    <section id="dashboard">
      <div class="panel-head">
        <h2>Caixas</h2>
        <div>
          <button id="newBoxBtn" class="primary">+ Nova caixa</button>
          <button id="resetAll" class="danger">Reset</button>
        </div>
      </div>

      <ul id="boxList" class="box-list"></ul>

      <div id="totalWrap" class="total-wrap hidden">
        <span>Total</span>
        <strong id="totalBalance">R$ 0,00</strong>
      </div>

      <!-- Formul√°rio de nova caixa -->
      <div id="newBoxForm" class="card hidden">
        <h3>Nova Caixa</h3>

        <label>Nome da caixa
          <input type="text" id="boxName" placeholder="Ex.: Mercado" />
        </label>

        <fieldset class="period-field">
          <legend>Per√≠odo de controle</legend>
          <label><input type="radio" name="period" value="diario" checked /> Di√°rio</label>
          <label><input type="radio" name="period" value="semanal" /> Semanal</label>
          <label><input type="radio" name="period" value="mensal" /> Mensal</label>
        </fieldset>

        <label>Valor para o per√≠odo
          <input type="number" id="boxAmount" inputmode="decimal" step="0.01" placeholder="Ex.: 50,00" />
        </label>

        <div class="actions">
          <button id="cancelNewBox" class="ghost">Cancelar</button>
          <button id="createBox" class="primary">Criar Caixa</button>
        </div>
      </div>
    </section>

    <!-- Vis√£o da Caixa -->
    <section id="boxView" class="hidden">
      <button class="ghost back" id="backToDashboard">‚Üê Voltar</button>

      <div class="box-header">
        <div class="color-bar" id="boxColor"></div>
        <div class="box-title">
          <h2 id="boxNameTitle">Caixa</h2>
          <div id="boxMeta" class="meta"></div>
        </div>
      </div>

      <div class="balance">
        <span>Saldo</span>
        <strong id="boxBalance" class="balance-positive">R$ 0,00</strong>
      </div>

      <div class="card">
        <h3>Registrar gasto</h3>
        <div class="row">
          <input type="number" id="expenseValue" inputmode="decimal" step="0.01" placeholder="Valor do gasto" />
          <button id="addExpense" class="primary">Adicionar</button>
        </div>
      </div>

      <div class="card">
        <h3>Gastos do per√≠odo</h3>
        <ul id="expenseList" class="expense-list"></ul>
      </div>

      <div class="row end">
        <button id="editBox" class="ghost">Editar caixa</button>
        <button id="deleteBox" class="danger">Excluir caixa</button>
      </div>

      <!-- Editor da caixa -->
      <div id="editBoxForm" class="card hidden">
        <h3>Editar Caixa</h3>

        <label>Nome
          <input type="text" id="editName" />
        </label>

        <fieldset class="period-field">
          <legend>Per√≠odo</legend>
          <label><input type="radio" name="editPeriod" value="diario" /> Di√°rio</label>
          <label><input type="radio" name="editPeriod" value="semanal" /> Semanal</label>
          <label><input type="radio" name="editPeriod" value="mensal" /> Mensal</label>
        </fieldset>

        <label>Valor por per√≠odo
          <input type="number" id="editAmount" inputmode="decimal" step="0.01" />
        </label>

        <div class="actions">
          <button id="cancelEdit" class="ghost">Cancelar</button>
          <button id="saveEdit" class="primary">Salvar</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Rodap√© fixo vis√≠vel no app -->
  <footer class="foot">
    <small>
      Simple$$ ‚Äî minimalista, local e privado ‚Ä¢ UTC-3
      &nbsp;|&nbsp;
      <a href="/simpless/sobre.html">Sobre</a>
    </small>
  </footer>

  <!-- JS -->
  <script src="/simpless/js/app.js?v=9" defer></script>

  <!-- Registro do Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("/simpless/sw.js")
          .then(reg => console.log("Service Worker registrado:", reg.scope))
          .catch(err => console.error("Erro ao registrar Service Worker:", err));
      });
    }
  </script>
</body>
</html>
